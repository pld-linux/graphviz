Index: configure.ac
===================================================================
RCS file: /home/cvsroot/graphviz2/configure.ac,v
retrieving revision 1.327
retrieving revision 1.328
@@ -23,20 +23,6 @@
 AC_SUBST(GRAPHVIZ_VERSION_MINOR)
 AC_SUBST(GRAPHVIZ_VERSION_MICRO)
 
-# Windows version numbers
-# For the build number: months since Jan 2000, day of month from the timestamp
-# For the revision number: hour, minute from the timestamp
-
-if test $GRAPHVIZ_VERSION_MICRO = "0"; then
-	GRAPHVIZ_VERSION_BUILD=0
-	GRAPHVIZ_VERSION_REVISION=0
-else
-	GRAPHVIZ_VERSION_BUILD=`expr \( ${GRAPHVIZ_VERSION_MICRO:0:4} - 2000 \) \* 12 + ${GRAPHVIZ_VERSION_MICRO:4:2}`${GRAPHVIZ_VERSION_MICRO:6:2}
-	GRAPHVIZ_VERSION_REVISION=${GRAPHVIZ_VERSION_MICRO:9:4}
-fi
-AC_SUBST(GRAPHVIZ_VERSION_BUILD)
-AC_SUBST(GRAPHVIZ_VERSION_REVISION)
-
 dnl ===========================================================================
 
 # libtool shared library version for main libs (cdt, graph, gvc)
@@ -100,6 +86,22 @@
 AC_DEFINE_UNQUOTED(GVPLUGIN_VERSION,$GVPLUGIN_VERSION,[Compatibility version number for plugins.])
 AC_SUBST(GVPLUGIN_VERSION)
 
+GRAPHVIZ_VERSION_BUILD=0
+GRAPHVIZ_VERSION_REVISION=0
+case "${host_os}" in
+  *uwin* | *cygwin* | *mingw32* )
+	# Windows version numbers
+	# For the build number: months since Jan 2000, day of month from the timestamp
+	# For the revision number: hour, minute from the timestamp
+	if test $GRAPHVIZ_VERSION_MICRO != "0"; then
+		GRAPHVIZ_VERSION_BUILD=`expr \( ${GRAPHVIZ_VERSION_MICRO:0:4} - 2000 \) \* 12 + ${GRAPHVIZ_VERSION_MICRO:4:2}`${GRAPHVIZ_VERSION_MICRO:6:2}
+		GRAPHVIZ_VERSION_REVISION=${GRAPHVIZ_VERSION_MICRO:9:4}
+	fi
+	;;
+esac
+AC_SUBST(GRAPHVIZ_VERSION_BUILD)
+AC_SUBST(GRAPHVIZ_VERSION_REVISION)
+
 LIBPOSTFIX=
 case "${host_os}" in
   *linux* )
